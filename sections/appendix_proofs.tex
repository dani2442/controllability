\section{Proofs}\label{app:proofs}

\subsection{Proof of the continuous-time Hautus test}\label{app:proof:hautus-margin-necessary}
\begin{proof}
  If $(\mat{A},\mat{B})$ is not controllable, then by the (continuous-time) Hautus test there exist $\lambda\in\CC$ and $v\neq 0$ such that $v^*\mat{P}_\lambda=0$.
  Using \eqref{eq:hautus-continuous-factorization}, this gives $v^*\mat{H}_\lambda(T)=v^*\mat{P}_\lambda\mat{S}_Z(T)=0$, hence $\operatorname{rank}(\mat{H}_\lambda(T))<n$.
  This proves the contrapositive of the first implication in Theorem~\ref{thm:hautus-margin-necessary}.

  Conversely, assume $(\mat{A},\mat{B})$ is controllable and $\mat{S}_Z(T)$ is invertible.
  Then $\mat{P}_\lambda$ has full row rank for every $\lambda\in\CC$ and \eqref{eq:hautus-continuous-factorization} implies
  \[
    \operatorname{rank}(\mat{H}_\lambda(T))
    =\operatorname{rank}(\mat{P}_\lambda\mat{S}_Z(T))
    =\operatorname{rank}(\mat{P}_\lambda)
    =n
    \qquad\forall \lambda\in\CC,
  \]
  which proves the converse.
\end{proof}


\subsection{Proof of the cross-moment error bound}\label{app:proof:hautus-cross-moment-high-prob}
\begin{proof}
  Let $\mat{M}(T):=\int_0^T \d W(t)\,z(t)^\top\in\R^{q\times (n+m)}$. Conditional on the path $\{z(t)\}_{t\in[0,T]}$, $\mat{M}(T)$ is a centered Gaussian matrix whose rows are independent and satisfy
  \[
    \E\big[\mat{M}(T)_{i,:}^\top \mat{M}(T)_{i,:}\mid z\big] = \int_0^T z(t)z(t)^\top\,\d t = \widetilde{\mat{S}}_Z(T),\qquad i=1,\dots,q.
  \]
  Therefore, conditional on $z$, we have the distributional identity $\mat{M}(T)\stackrel{d}{=}\mat{G}\widetilde{\mat{S}}_Z(T)^{1/2}$ where $\mat{G}\in\R^{q\times (n+m)}$ has i.i.d.\ $\mathcal{N}(0,1)$ entries.
  Using \eqref{eq:hautus-cross-moment-error},
  \[
    \widetilde{\mat{P}}_\lambda(T)-\mat{P}_\lambda
    \stackrel{d}{=}
    \boldsymbol{\beta}\,\mat{G}\widetilde{\mat{S}}_Z(T)^{-1/2},
  \]
  conditional on $z$, hence
  \[
    \|\widetilde{\mat{P}}_\lambda(T)-\mat{P}_\lambda\|_2
    \le
    \frac{\|\boldsymbol{\beta}\|_2}{\sqrt{\sigma_{\min}(\widetilde{\mat{S}}_Z(T))}}\;\|\mat{G}\|_2.
  \]
  The standard Gaussian matrix bound $\mathbb{P}\big(\|\mat{G}\|_2\ge \sqrt{q}+\sqrt{n+m}+t\big)\le e^{-t^2/2}$ (valid for all $t\ge 0$; see, e.g., \cite[Theorem~4.4.5]{vershyninHighDimensionalProbability2018}) yields \eqref{eq:hautus-cross-moment-high-prob} by choosing $t=\sqrt{2\log(1/\delta)}$ and using $\sigma_{\min}(\widetilde{\mat{S}}_Z(T))=T\sigma_{\min}(\bar{\mat{S}}_Z(T))$.
\end{proof}

\subsection{Proof of the finite candidate set result}\label{app:proof:hautus-operator-finite-lambda}
\begin{proof}
  Fix $\lambda\in\CC$ and assume $\operatorname{rank}(\mathcal{P}(\lambda))<n$.
  Since the codomain is $\CC^n$, the left nullspace is nontrivial, so there exists $0\neq w\in\CC^n$ with
  $\mathcal{P}(\lambda)^*w=0$, i.e.\ $\dot\X^*w=\overline{\lambda}\X^*w$.
  Left-multiply by $(\X\X^*)^{-1}\X$ to obtain
  \[
    \mat{K}w
    =(\X\X^*)^{-1}\X\dot\X^*w
    =\overline{\lambda}\,(\X\X^*)^{-1}\X\X^*w
    =\overline{\lambda}\,w,
  \]
  so $\overline{\lambda}\in\sigma(\mat{K})$.
  Since $x$ is real-valued, the matrices $\X\X^*$ and $\X\dot\X^*$ are real, hence $\mat{K}\in\R^{n\times n}$. For real matrices, eigenvalues come in conjugate pairs, so $\sigma(\mat{K})$ is closed under complex conjugation. Therefore, $\lambda = \overline{\overline{\lambda}} \in\sigma(\mat{K})$.
\end{proof}


\subsection{Proof of the quantitative margin bound}\label{app:proof:hautus-operator-margin-bound}
\begin{proof}
  Fix $w\in\CC^n$.
  Since $w^*(\dot\X-\lambda\X)$ is a bounded linear functional on $L^2(0,T)$, we have
  \[
    \big\|w^*(\dot\X-\lambda\X)\big\|
    =\big\|(\dot\X^*-\overline{\lambda}\,\X^*)w\big\|_{L^2(0,T)}.
  \]
  Moreover,
  \[
    (\mat{K}-\overline{\lambda}\,\mat{I})w
    =(\X\X^*)^{-1}\X(\dot\X^*-\overline{\lambda}\,\X^*)w,
  \]
  hence
  \[
    \|(\mat{K}-\overline{\lambda}\,\mat{I})w\|
    \le \|(\X\X^*)^{-1}\X\|\,\big\|(\dot\X^*-\overline{\lambda}\,\X^*)w\big\|_{L^2(0,T)}.
  \]
  Using \eqref{eq:hautus-operator-gram-identity}, $\|(\dot\X^*-\overline{\lambda}\,\X^*)w\|_{L^2(0,T)}^2=w^*\mat{G}_\lambda(u)w$, so
  \[
    w^*\mat{G}_\lambda(u)w \ge \frac{\|(\mat{K}-\overline{\lambda}\,\mat{I})w\|^2}{\|(\X\X^*)^{-1}\X\|^2}.
  \]
  Since $\mat{S}_Z(T)\succ 0$, \eqref{eq:hautus-operator-G-from-H} gives
  \[
    \mat{G}_\lambda(u)=\mat{H}_\lambda(T)\mat{S}_Z(T)^{-1}\mat{H}_\lambda(T)^*.
  \]
  Therefore, for every $w\in\CC^n$,
  \[
    w^*\mat{G}_\lambda(u)w
    =w^*\mat{H}_\lambda(T)\mat{S}_Z(T)^{-1}\mat{H}_\lambda(T)^*w
    \le \frac{1}{\sigma_{\min}(\mat{S}_Z(T))}\,\|\mat{H}_\lambda(T)^*w\|_2^2,
  \]
  i.e.,
  \[
    \|\mat{H}_\lambda(T)^*w\|_2^2 \ge \sigma_{\min}(\mat{S}_Z(T))\,w^*\mat{G}_\lambda(u)w.
  \]
  Combining with the lower bound on $w^*\mat{G}_\lambda(u)w$ above and taking the minimum over $\|w\|_2=1$ gives
  \[
    \sigma_{\min}\!\big(\mat{H}_\lambda(T)\big)^2
    =\min_{\|w\|_2=1}\|\mat{H}_\lambda(T)^*w\|_2^2
    \ge
    \sigma_{\min}(\mat{S}_Z(T))\,
    \frac{\sigma_{\min}(\mat{K}-\overline{\lambda}\,\mat{I})^2}{\|(\X\X^*)^{-1}\X\|^2},
  \]
  which yields the claimed bound after taking square roots.
  The final claim follows since $\sigma_{\min}(\mat{K}-\overline{\lambda}\,\mat{I})>0$ whenever $\lambda\notin\sigma(\mat{K})$.
\end{proof}

\subsection{Proof of the \texorpdfstring{$L^2$}{L2}-budget isotropic design}\label{app:proof:hautus-isotropic-input}
\begin{proof}
  Since $\mat{S}_U(u)\succeq 0$, we have $\lambda_{\min}(\mat{S}_U(u))\le \tfrac{1}{m}\operatorname{tr}(\mat{S}_U(u))$.
  Moreover,
  \begin{align*}
    \operatorname{tr}(\mat{S}_U(u))
    &=\int_0^T \operatorname{tr}\!\big(u(t)u(t)^\top\big)\,\d t\\
    &=\int_0^T \|u(t)\|_2^2\,\d t\\
    &=\|u\|_{L^2(0,T)}^2
    \le 1,
  \end{align*}
  which gives the upper bound.
  For achievability, pick an orthonormal set $\{\varphi_i\}_{i=1}^m\subset L^2(0,T)$ and define
  $u(t):=\frac{1}{\sqrt m}[\varphi_1(t)\ \cdots\ \varphi_m(t)]^\top$; then $\mat{S}_U(u)=\frac{1}{m}\mat{I}_m$.
\end{proof}

\subsection{Proof of the \texorpdfstring{$H^1$}{H1}-budget isotropic design and characterization of optimizers}
\label{app:proof:hautus-isotropic-input-h1}

\begin{proof}
  Expand $u$ in the orthonormal Neumann basis $\{\psi_k\}_{k\ge 0}$ as
  $u(t)=\sum_{k\ge 0}\psi_k(t)a_k$ with coefficients $a_k\in\R^m$. Then
  \[
    \mat{S}_U(u)=\sum_{k\ge 0} a_k a_k^\top,
    \qquad
    \|u\|_{H^1(0,T)}^2=\sum_{k\ge 0}\Big(1+\big(\tfrac{k\pi}{T}\big)^2\Big)\|a_k\|_2^2.
  \]
  Let $w_k:=1+(\tfrac{k\pi}{T})^2$ and $W:=\operatorname{diag}(w_0,w_1,\dots)$, and define
  $A:=[a_0\ a_1\ \cdots]\in \R^{m\times \infty}$, so that $\mat{S}_U(u)=AA^\top$ and
  $\|u\|_{H^1(0,T)}^2=\operatorname{tr}(A W A^\top)$. Write the compact SVD of $A$ as
  \[
    A=\mat{S}_U(u)^{1/2}R,
    \qquad
    RR^\top=\mat{I}_m,
  \]
  so that $\Pi:=R^\top R$ is a rank-$m$ orthogonal projector. Then
  \begin{align*}
    \|u\|_{H^1(0,T)}^2
    &=\operatorname{tr}\!\big(\mat{S}_U(u)^{1/2}RWR^\top \mat{S}_U(u)^{1/2}\big)\\
    &=\operatorname{tr}\!\big(\mat{S}_U(u)\,RWR^\top\big)\\
    &\ge \lambda_{\min}(\mat{S}_U(u))\,\operatorname{tr}(RWR^\top)\\
    &= \lambda_{\min}(\mat{S}_U(u))\,\operatorname{tr}(W\Pi).
  \end{align*}

  \paragraph{Minimizing $\operatorname{tr}(W\Pi)$.}
  Since $W$ is diagonal with strictly increasing entries $w_k$, we have
  \[
    \min_{\substack{\Pi=\Pi^\top=\Pi^2\\ \operatorname{rank}(\Pi)=m}}\operatorname{tr}(W\Pi)
    \;=\;
    \sum_{k=0}^{m-1} w_k,
  \]
  and, moreover, the minimizer is unique: $ \Pi_\star = \operatorname{diag}(\mat{I}_m,0,0,\dots)$, i.e., projection onto the span of the first $m$ coordinate vectors.
  Therefore
  \[
    \|u\|_{H^1(0,T)}^2
    \;\ge\;
    \lambda_{\min}(\mat{S}_U(u))\sum_{k=0}^{m-1} w_k.
  \]
  Under the budget $\|u\|_{H^1(0,T)}^2\le 1$ this yields
  \[
    \lambda_{\min}(\mat{S}_U(u))
    \;\le\;
    \alpha
    \;:=\;
    \Big(\sum_{k=0}^{m-1} w_k\Big)^{-1}
    \;=\;
    \Big(\sum_{k=0}^{m-1}\Big(1+\big(\tfrac{k\pi}{T}\big)^2\Big)\Big)^{-1}.
  \]
  \noindent\textbf{Tightness and characterization of all optimizers.}
  Suppose the bound is tight, i.e.,
  $\|u\|_{H^1(0,T)}^2\le 1$ and $\lambda_{\min}(\mat{S}_U(u))=\alpha$.
  Then equality must hold throughout the chain of inequalities above. In particular:

  \smallskip
  \noindent\emph{(i) Low-mode support.}
  Equality in $\operatorname{tr}(W\Pi)\ge \sum_{k=0}^{m-1}w_k$ forces $\Pi=\Pi_\star$
  by uniqueness of the minimizer. Equivalently, the row space of $R$ lies in the span of the
  first $m$ coordinates, which implies that $A$ has no columns beyond the first $m$:
  \[
    a_k=0\quad\text{for all }k\ge m,
    \qquad\text{hence}\qquad
    u(t)=\sum_{k=0}^{m-1}\psi_k(t)a_k.
  \]

  \smallskip
  \noindent\emph{(ii) Isotropy of the Gramian.}
  Equality in
  \[
    \operatorname{tr}\!\big(\mat{S}_U(u)\,RWR^\top\big)
    \;\ge\;
    \lambda_{\min}(\mat{S}_U(u))\,\operatorname{tr}(RWR^\top)
  \]
  forces $\mat{S}_U(u)$ to be isotropic. Indeed, since $RWR^\top\succ 0$ (because $w_k>0$ and $R$
  has full row rank), write $\mat{S}_U(u)=U\operatorname{diag}(s_1,\dots,s_m)U^\top$ with
  $s_m=\lambda_{\min}(\mat{S}_U(u))$. Then
  \[
    \operatorname{tr}\!\big((\mat{S}_U(u)-s_m\mat{I}_m)\,RWR^\top\big)\ge 0,
  \]
  with equality if and only if $\mat{S}_U(u)-s_m\mat{I}_m=0$ since $RWR^\top\succ 0$.
  Hence $\mat{S}_U(u)=\lambda_{\min}(\mat{S}_U(u))\mat{I}_m=\alpha \mat{I}_m$.

  \smallskip
  \noindent\emph{(iii) Explicit form of all maximizers.}
  From (i), $A$ effectively reduces to an $m\times m$ matrix $A_m=[a_0\ \cdots\ a_{m-1}]$.
  From (ii), we have $A_mA_m^\top=\mat{S}_U(u)=\alpha \mat{I}_m$, so
  $A_m=\sqrt{\alpha}\,Q$ for some $Q\in O(m)$. Defining
  \[
    \Psi(t):=\begin{bmatrix}\psi_0(t)\\ \vdots\\ \psi_{m-1}(t)\end{bmatrix}\in\R^m,
  \]
  we obtain the complete optimizer family
  \[
    u(t)=\sqrt{\alpha}\,Q\,\Psi(t),
    \qquad Q\in O(m),
  \]
  which satisfies $\|u\|_{H^1(0,T)}^2=\alpha\sum_{k=0}^{m-1}w_k=1$ and
  $\mat{S}_U(u)=\alpha \mat{I}_m$.
\end{proof}

